<!DOCTYPE HTML><html>
	<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8"> <meta content="width=device-width,minimum-scale=1.0" name="viewport">
		<title>Next AutoIndex Installation Wizard</title>
		<style>
		body{margin: 0px;
padding: 0px;
background:#EDEDED;
color: #555;
font-family: Tahoma,Open Sans,Arial,Ubuntu Sans;
font-size: 13px;}
		#wrap{max-width: 95%;
margin: 10px auto;}
		.logo{background: #118D73 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAABKCAYAAAB+f+4bAAAA0klEQVQokY3HOVICURiF0Vv1egOP1QnIrCFjNzOokeCAA7rfz+gG/gFFcIKj2u8S04X8LLCrc15gqp3nWMj3HIupMNW+Kizks8Qu5aPE/iefSkz5NMOU32dYzBRTfptiIa8TLORljIUcx5jycYQpH0aY8mGIKT8PMRVP95iKxzss5GGAhewHmIp9H1Ox62Mqdj1MxbaHKW17mNKmi4Wsu5jSuoMprTqY0qqNhSzbmNKyhSktWljI/Ba7lKqJhZRNTKlsYCGzBhZTx5SmdezqTG6wP1GVsT9zxJ0sAAAAAElFTkSuQmCC") repeat;
		text-align:center;
padding: 8px 10px;
margin: 0px 0px;
color: #FFF;
font-weight: bold;}
.l{background: none repeat scroll 0% 0% #FFF;
border-bottom: 1px solid #DDD;
padding: 7px 11px;
font-size: 15px;
font-weight: bold;
color: #118B71;
line-height: 24px;}
.info{background: none repeat scroll 0% 0% #FFF;
border-bottom: 1px solid #DDD;
padding: 7px 11px;
font-size: 14px;
line-height: 24px;}
.ttl {background: #118D73 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAABKCAYAAAB+f+4bAAAA0klEQVQokY3HOVICURiF0Vv1egOP1QnIrCFjNzOokeCAA7rfz+gG/gFFcIKj2u8S04X8LLCrc15gqp3nWMj3HIupMNW+Kizks8Qu5aPE/iefSkz5NMOU32dYzBRTfptiIa8TLORljIUcx5jycYQpH0aY8mGIKT8PMRVP95iKxzss5GGAhewHmIp9H1Ox62Mqdj1MxbaHKW17mNKmi4Wsu5jSuoMprTqY0qqNhSzbmNKyhSktWljI/Ba7lKqJhZRNTKlsYCGzBhZTx5SmdezqTG6wP1GVsT9zxJ0sAAAAAElFTkSuQmCC") repeat scroll 0% 0% / auto 37px;
padding: 8px 10px;
margin: 2px 0px 0px;
color: #FFF;
font-weight: bold;
}
#foot{color: rgba(152, 152, 152, 1);
text-align: center;
padding: 8px;
margin-top: 5px;}
input[type=text]{padding: 6px 10px;
margin: 1px;
border: 1px solid #E4E4E4;
background: none repeat scroll 0% 0% #F5F5F5;
font-family: inherit;
font-size: inherit;}
input[type=text]:focus{border:1px solid #118B71;background:#fff}
input[type=submit]{display: block;
text-align: center;
width: 96%;
padding: 7px;
background: #128E73 none repeat scroll 0% 0%;
border-color: #5BB6A2;
color: #FFF;
font-size: 15px;
font-weight: bold;
margin: 0px 4px;
border-width: 0px 0px 3px 0px;}
#tip{font-weight: normal;
font-size: 13px;
color: rgba(131, 131, 131, 1);}
.good{font-weight: bold;
color: rgb(0, 126, 10);
font-size: 13px;
margin: 0px 6px;}
.bad{font-weight: bold;
color: red;
font-size: 13px;
margin: 0px 6px;}
.sep{padding: 2px 0px;
font-size: 13px;
border-bottom: 1px solid #F2F2F2;}
.sep:last-child{border:none}
		</style>
		<link rel="shortcut icon" href="data:image/png;base64,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" type="image/x-png"/>
	</head>
	<body>
	<div id="wrap">
	<div class="logo"><img src="nai.png" alt="Next AutoIndex"/></div>
		<div class='ttl'>Server Configuration</div>
		<div class="info">
		<div class="sep">
		PHP Version: <?php 
		$php=phpversion();
		echo"<b>$php</b>";
		if($php > 5.0){
		echo '<span class="good">GOOD!</span>';
		}
		else{
		echo '<span class="bad">BAD!</span>';
		}
		?>
		<div id="tip">PHP version should be 5.x or higher</div>
		</div>
				<div class="sep">
		cURL Library: <?php 

		if(function_exists('curl_version')){
		echo '<b>Found</b> <span class="good">GOOD!</span>';
		}
		else{
		echo '<b>Not Found</b> <span class="bad">BAD!</span>';
		}
		?>
		<div id="tip">if cURL library not installed allow_url_fopen should be <em>on</em></div>
		</div>
		<div class="sep">
		allow_url_fopen: <?php 

		if(ini_get('allow_url_fopen')){
		echo '<b>On</b> <span class="good">GOOD!</span>';
		}
		else{
		echo '<b>Off</b> <span class="bad">BAD!</span>';
		}
		?>
		<div id="tip">required if cURL is not installed</div>
		</div>	
		<div class="sep">
		GD Library: <?php 

		if(extension_loaded('gd') && function_exists('gd_info')){
		echo '<b>Found</b> <span class="good">GOOD!</span>';
		}
		else{
		echo '<b>Not Found</b> <span class="bad">BAD!</span>';
		}
		?>
		<div id="tip">required for image watermarking</div>
		</div>
		</div>
		<div class="ttl">Installation Wizard</div>
<?php
if($_POST){

$fp = fopen('inc/settings.php','w');

$content = '
<?php
/*
Project Name: Next Auto Index
Project URI: http://wapindex.mirazmac.info
Project Version: 3.2
Licence: GPL v3
*/
## This is a modified version of Master Autoindex. So all source rights goes to ionutvmi ##

$set->db_name = "'.$_POST['name'].'";
$set->db_user = "'.$_POST['user'].'";
$set->db_host = "'.$_POST['host'].'";
$set->db_pass = "'.$_POST['pass'].'";


$set->name = "'.$_POST['site_name'].'"; // site name
$set->url = "'.$_POST['site_url'].'"; // site url
$set->logo = "'.$_POST['site_logo'].'"; // logo url (full url http://site.com/logo.png)
$set->perpage = "10"; // how many records per page
define("MAI_PREFIX","'.$_POST['prefix'].'");
';

if(!fwrite($fp,trim($content)))
	$error = 1;

fclose($fp);

include "inc/settings.php";

include "lib/mysql.class.php";

$db = new dbConn($set->db_host,$set->db_user,$set->db_pass,$set->db_name);


if(!$db->query("CREATE TABLE IF NOT EXISTS `".$_POST['prefix']."files` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(200) NOT NULL,
  `path` text NOT NULL,
  `indir` int(11) NOT NULL DEFAULT '0',
  `views` int(11) NOT NULL,
  `dcount` int(11) NOT NULL,
  `time` int(11) NOT NULL,
  `size` int(11) NOT NULL,
  `icon` text NOT NULL,
  `description` text NOT NULL,
  `isdir` int(11) NOT NULL,
  `voice` int(11) NOT NULL DEFAULT '0',
  `watermark` int(11) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;"))	$error = 1;
if(!$db->query("INSERT INTO `".$_POST['prefix']."files` (`id`, `name`, `path`, `indir`, `views`, `dcount`, `time`, `size`, `icon`,`isdir`) VALUES
(1, 'Games', '/files/Games', 0, 0, 0, 1348259936, 0, '', 1);"))	$error = 1;
if(!$db->query("CREATE TABLE IF NOT EXISTS `".$_POST['prefix']."plugins_settings` (
  `name` varchar(200) NOT NULL,
  `value` text NOT NULL,
  `title` text NOT NULL,
  `description` text NOT NULL,
  `type` text NOT NULL,
  `plugin` text NOT NULL,
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;"))	$error = 1;
if(!$db->query("CREATE TABLE IF NOT EXISTS `".$_POST['prefix']."updates` (
  `id` int(11) NOT NULL auto_increment,
  `text` text NOT NULL,
  `time` int(11) NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=15 ;"))	$error = 1;
if(!$db->query("CREATE TABLE IF NOT EXISTS `".$_POST['prefix']."request` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `text` text NOT NULL,
  `reply` text NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;"))	$error = 1;
if(!$db->query("CREATE TABLE IF NOT EXISTS `".$_POST['prefix']."settings` (
  `admin_pass` varchar(100) NOT NULL,
  `main_msg` text NOT NULL,
  `active_plugins` text NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;"))	$error = 1;
if(!$db->query("INSERT INTO `".$_POST['prefix']."settings` (`admin_pass`, `main_msg`, `active_plugins`) VALUES
('".sha1(trim($_POST['admin_pass']))."', 'Welcome to our site !\r\nHope you enjoy it :D', 'a:0:{}');"))	$error = 1;
if(!$db->query("CREATE TABLE IF NOT EXISTS `".$_POST['prefix']."files` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `text` text NOT NULL,
  `time` int(11) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;"))	$error = 1;
if($error){
echo "Fatal Error!<br/> Check if <b>/inc/settings.php</b> is writable and if your prefix is correct.";
}else {
echo "<div class='l' style='font-size: 15px;font-weight: bold;padding: 8px;color: #28B8F7;'>Installation Completed!</div>
<div class='l'>Installation completed successfully. Your site is ready to use now. <br/><span style='color:red'>Please delete this file right now!</span></div>";

// @unlink(__FILE__);
}

}else{

@chmod("files",0777);
@chmod("inc/settings.php",0666);

echo "<form action='?' method='post'>
<div class='l'>
Database Host<br/><input type='text' name='host'><div id='tip'>Insert your MySQL Database Host. Usually its <em>localhost</em> or <em>mysql.xxxx.ext</em></div></div>
<div class='l'>
Database User<br/><input type='text' name='user'><div id='tip'>Insert your database username</div></div>
<div class='l'>
Database Password<br/><input type='text' name='pass'>
<div id='tip'>Insert your database password</div></div>
<div class='l'>
Database Name<br/><input type='text' name='name'><div id='tip'>Insert your database name</div></div>
<div class='l'>
Table Prefix: <br/><input type='text' name='prefix' value='nxt_'><div id='tip'>If you don't know whats this then keep it as is.</div></div>
<div class='ttl'>Site Setup</div><div class='l'>
Site Title<br/><input type='text' name='site_name' value='Next AutoIndex'><div id='tip'>The name of your site</div></div>
<div class='l'>
Site Logo URL(keep blank if you don't have)<br/><input type='text' name='site_logo' value=''>
<div id='tip'>The full URL to your logo. You can always change this later.</div>
</div>
<div class='l'>
Site URL<br/><input type='text' name='site_url' value='http://".$_SERVER['HTTP_HOST'].dirname($_SERVER['PHP_SELF'])."'>
<div id='tip'>The full URL to your site <b>without</b> any slash(/) at end.</div>
</div>
<div class='l'>
Admin Pass: <br/><input type='text' name='admin_pass' value=''><div id='tip'>Insert your admin pass</div></div>
<br/><input type='submit' value='Run the Install!'>
</form>";

}
?>
<div id='foot'>Next AutoIndex - Reborn of MasterAuto Index<br/>Running version 3.2 a.k.a <em>Rising Moon</em> </div>
	</div></body>
</html>